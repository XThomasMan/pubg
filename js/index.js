var res=["../img/bg/bg-index-1.jpg","../img/bg/bg-index-2.jpg","../img/bg/bg-index-3.jpg","../img/bg/bg-index-4.jpg","../img/bg/bg-index-5.jpg","../img/bg/bg-index-6.jpg","../img/bg/bg-index-7.jpg","../img/bg/bg-index-8.jpg","../img/bg/bg-index-9.jpg","../img/bg/bg-index-10.jpg","../img/bg/bg-index-11.jpg","../img/bg/bg-index-12.jpg","../img/bg/bg-index-13.jpg","../img/bg/bg-index-14.jpg","../img/bg/bg-index-15.jpg","../img/bg/bg-index-16.jpg","../img/bg/bg-index-17.jpg","../img/bg/bg-index-18.jpg","../img/bg/bg-index-19.jpg","../img/bg/bg-index-20.jpg","../img/bg-guide.png","../img/bg-correct.png","../img/sprites-widget.png","../img/sprites-title.png","../img/sprites-audio.png","../img/bg-kv.jpg","../img/sprites-kv.png","../img/text/bg-text-1.png","../img/text/bg-text-2.png","../img/text/bg-text-3.png","../img/text/bg-text-4.png","../img/text/bg-text-5.png","../img/text/bg-text-6.png","../img/text/bg-text-7.png","../img/text/bg-text-8.png","../img/text/bg-text-9.png","../img/text/bg-text-10.png","../img/text/bg-text-11.png"],myScroll={},isReset=!1,pageH=603,pageW=375,width=window.innerWidth,height=window.innerHeight,pageRatio=pageH/pageW,windowRatio=height/width,questionIndex=0,isMove=!1,isEnter9=!1,nickname="你",questionPosition=[1844,4294,8526,11038,13316,15798,19250,21398,24132,25636],answer=[2,2,1,4,1,2,3,4,[1,4,6,7,8],4],question9=[],multiple=.5*(height/pageH)/(windowRatio/pageRatio),isScope=!1,$guide=$("#guide"),audio={$voice:$("#music"),oAudio:document.getElementById("audio"),audioEvent:function(){var e=this;e.oAudio&&(e.oAudio.addEventListener("canplaythrough",function(){e.oAudio.play()}),e.oAudio.addEventListener("timeupdate",function(){e.oAudio.currentTime>=e.oAudio.duration-1&&(e.oAudio.currentTime=0,e.oAudio.play())},!1))},playAudio:function(e,i){var t=this;t.oAudio&&(t.oAudio.src=e,i&&t.startAudio())},startAudio:function(){var e=this;e.oAudio&&(e.oAudio.load(),e.oAudio.play(),e.state.status=!0)},stopAudio:function(){var e=this;e.oAudio&&(e.oAudio.pause(),e.state.status=!1)},event:function(){var e=this;e.$voice.on("touchend",function(){return e.state.status?(e.stopAudio(),e.$voice.removeClass("music__on").addClass("music__off")):(e.startAudio(),e.$voice.removeClass("music__off").addClass("music__on")),!1})},init:function(){var e=this;e.state={status:!1},e.audioEvent(),e.$voice.removeClass("music__off").addClass("music__on"),e.state.status=!0,e.event(),e.playAudio("./media/music.mp3",e.state.status),document.addEventListener("WeixinJSBridgeReady",function(){e.startAudio()},!1)}},IndexPage={init:function(){document.addEventListener("touchmove",function(e){e.preventDefault()},{passive:!1}),this.loading(),this.login()},loading:function(){var e=this;new mo.Loader(res,{loadType:1,minTime:300,onLoading:function(e,i){var t=parseInt(e/i*100);$("#progressBar").css("transform","translate("+(-100+t)+"%, 0)"),setTimeout(function(){$("#doll").html(t+"%")},0)},onComplete:function(){$("#loading").addClass("hide"),e.action(),e.bindEvents()}})},reset:function(){questionIndex=0,myScroll.scrollTo(0,0),question9=[],$(".btn").removeClass("active correct"),$("#kv").addClass("hide"),$(".page-question").removeClass("active"),audio.startAudio(),isEnter9=!1,isReset=!0},action:function(){audio.init(),$(".windows, #guide").addClass("active"),myScroll=new IScroll("#wrapper",{mouseWheel:!0,bounceTime:1e3,bounceLock:!0,preventDefault:!0,probeType:3}),myScroll.on("scroll",function(){isMove=!0,$guide.removeClass("active");var e=-questionPosition[questionIndex]*multiple;this.y<=e&&($(".page-question-"+(parseInt(questionIndex)+1)).addClass("active"),myScroll.scrollTo(0,e),isScope=!0)}),myScroll.on("scrollStart",function(){isMove=!0}),myScroll.on("scrollEnd",function(){isMove=!1})},showKV:function(e){$("#kv").removeClass("hide");var i="./img/text/bg-text-"+e+".png";$("#text").attr("src",i),$("#chicken").addClass("active"),audio.stopAudio(),this.share(nickname,e)},login:function(){var e=this;TGLogin.init({wxAppId:"wx13051697527efc45"},function(i){var t=i.mGetPlatformType();"wx"===t?i.mWXLogin(function(i){nickname=i.nickname,e.share(nickname,0)}):"qq"===t?i.mQQLogin(function(i){nickname=i.nickname,e.share(nickname,0)}):i.mOpenQQ()})},share:function(e,i){var t="啊啊啊，"+e+"怂成狗了，连飞机都不敢上，速来围观！";i>=1&&3>=i?t="啧啧啧，"+e+"刚落地就凉凉了，快来帮帮这个菜鸡吧！":i>3&&8>=i?t="嘤嘤嘤，"+e+"跑毒不小心送了一波快递，求你给个爱的抱抱~":i>8&&10>=i?t="喵喵喵？"+e+"居然打进决战圈了？走，咱们去把他莽了吧！":11==i&&(t="666，"+e+"是活到最后的大神！来呀求怼求实锤呀~"),TGMobileShare({shareTitle:"绝地求生:全军出击",shareDesc:t,shareImgUrl:"../img/share.png",shareLink:"",actName:"a20171220pubgm"})},bindEvents:function(){function e(e,i){for(var t=0;t<e.length;t++)if(e[t]==i){e.splice(t,1);break}}var i=this;$(".btn").on("touchend",function(){if(!isMove){var t=$(this),n=t.data("value");if(t.hasClass("btn-3"))t.hasClass("active")?(t.removeClass("active"),e(question9,parseInt(n))):(t.addClass("active"),question9.push(parseInt(n)));else if(t.hasClass("btn-4")){if(!isEnter9){var s=0;isEnter9=!0;for(var o=0;o<answer[questionIndex].length;o++)if(question9.length>0)for(var a=0;a<question9.length;a++)answer[questionIndex][o]===question9[a]&&($(".page-question-9").find(".btn-3").eq(question9[a]-1).addClass("correct"),s++);s==answer[questionIndex].length?(!isReset&&$guide.addClass("active"),questionIndex++,isScope=!1):i.showKV(parseInt(questionIndex)+1)}}else t.siblings(".btn").hasClass("active")||t.hasClass("active")||(t.addClass("active"),parseInt(n)==answer[questionIndex]?(t.addClass("correct"),9==questionIndex?i.showKV(11):(0!=questionIndex||isReset||$guide.addClass("active"),questionIndex++,isScope=!1)):i.showKV(parseInt(questionIndex)+1))}}),$("#reset").on("touchend",i.reset)}};$(function(){IndexPage.init()});